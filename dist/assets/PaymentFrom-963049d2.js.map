{"version":3,"file":"PaymentFrom-963049d2.js","sources":["../../src/components/CheckoutForm/PaymentFrom.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { Typography, Button, Divider } from \"@mui/material\";\r\nimport {\r\n  Elements,\r\n  CardElement,\r\n  ElementsConsumer\r\n} from \"@stripe/react-stripe-js\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport { setError } from \"../../store/MainSlice\";\r\nconst Review= React.lazy(() => import(\"./Review\"))\r\nconst stripePromise = loadStripe(import.meta.env.VITE_STRIPE_PUBLIC_KEY);\r\n\r\nconst PaymentFrom = ({\r\n  shippingData,\r\n  checkoutToken,\r\n  nextStep,\r\n  backStep,\r\n  handleCaptureCheckout,\r\n  timeout\r\n}) => {\r\n  const handleSubmit = async (event, elements, stripe) => {\r\n    event.preventDefault();\r\n    if (!stripe || !elements) return;\r\n    const { error, paymentMethod } = await stripe.createPaymentMethod({\r\n      type: \"card\",\r\n      card: elements.getElement(CardElement)\r\n    });\r\n    if (error) {\r\n      Dispatch(setError(error));\r\n    } else {\r\n      const orderData = {\r\n        line_items: checkoutToken.line_items,\r\n        customer: {\r\n          firstname: shippingData.firstName,\r\n          lastname: shippingData.lastName,\r\n          email: shippingData.email\r\n        },\r\n        shipping: {\r\n          name: \"International\",\r\n          street: shippingData.address1,\r\n          town_city: shippingData.city,\r\n          county_state: shippingData.shippingSubdivision,\r\n          postal_zip_code: shippingData.zip,\r\n          country: shippingData.shippingCountry\r\n        },\r\n        fulfillment: { shipping_method: shippingData.shippingOption },\r\n        payment: {\r\n          gateway: \"stripe\",\r\n          stripe: {\r\n            payment_method_id: paymentMethod.id\r\n          }\r\n        }\r\n      };\r\n      handleCaptureCheckout(checkoutToken.id, orderData);\r\n      timeout();\r\n      nextStep();\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      <Review checkoutToken={checkoutToken} />\r\n      <Divider />\r\n      <Typography variant=\"h6\" gutterBottom style={{ margin: \"20px 0\" }}>\r\n        Payment method\r\n      </Typography>\r\n      <Elements stripe={stripePromise}>\r\n        <ElementsConsumer>\r\n          {({ elements, stripe }) => {\r\n            return (\r\n              <form onSubmit={(e) => handleSubmit(e, elements, stripe)}>\r\n                <CardElement />\r\n                <br /> <br />\r\n                <div\r\n                  style={{ display: \"flex\", justifyContent: \"space-between\" }}\r\n                >\r\n                  <Button\r\n                    variant=\"outlined\"\r\n                    color=\"secondary\"\r\n                    onClick={backStep}\r\n                  >\r\n                    Back\r\n                  </Button>\r\n                  <Button\r\n                    type=\"submit\"\r\n                    variant=\"contained\"\r\n                    disabled={!stripe}\r\n                    color=\"secondary\"\r\n                  >\r\n                    Pay {checkoutToken.subtotal.formatted_with_symbol}\r\n                  </Button>\r\n                </div>\r\n              </form>\r\n            );\r\n          }}\r\n        </ElementsConsumer>\r\n      </Elements>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PaymentFrom;\r\n"],"names":["Review","React","__vitePreload","stripePromise","loadStripe","PaymentFrom","shippingData","checkoutToken","nextStep","backStep","handleCaptureCheckout","timeout","handleSubmit","event","elements","stripe","error","paymentMethod","CardElement","setError","orderData","jsxs","Fragment","jsx","Divider","Typography","Elements","ElementsConsumer","e","Button"],"mappings":"o4CASA,MAAMA,EAAQC,EAAM,KAAK,IAAMC,EAAA,IAAA,OAAO,sBAAU,EAAC,kBAAA,CAAA,EAC3CC,EAAgBC,EAAW,6GAAsC,EAEjEC,GAAc,CAAC,CACnB,aAAAC,EACA,cAAAC,EACA,SAAAC,EACA,SAAAC,EACA,sBAAAC,EACA,QAAAC,CACF,IAAM,CACJ,MAAMC,EAAe,MAAOC,EAAOC,EAAUC,IAAW,CAElD,GADJF,EAAM,eAAe,EACjB,CAACE,GAAU,CAACD,EAAU,OAC1B,KAAM,CAAE,MAAAE,EAAO,cAAAC,CAAkB,EAAA,MAAMF,EAAO,oBAAoB,CAChE,KAAM,OACN,KAAMD,EAAS,WAAWI,CAAW,CAAA,CACtC,EACD,GAAIF,EACO,SAAAG,EAASH,CAAK,CAAC,MACnB,CACL,MAAMI,EAAY,CAChB,WAAYb,EAAc,WAC1B,SAAU,CACR,UAAWD,EAAa,UACxB,SAAUA,EAAa,SACvB,MAAOA,EAAa,KACtB,EACA,SAAU,CACR,KAAM,gBACN,OAAQA,EAAa,SACrB,UAAWA,EAAa,KACxB,aAAcA,EAAa,oBAC3B,gBAAiBA,EAAa,IAC9B,QAASA,EAAa,eACxB,EACA,YAAa,CAAE,gBAAiBA,EAAa,cAAe,EAC5D,QAAS,CACP,QAAS,SACT,OAAQ,CACN,kBAAmBW,EAAc,EACnC,CACF,CAAA,EAEoBP,EAAAH,EAAc,GAAIa,CAAS,EACzCT,IACCH,IACX,EAEF,OAEIa,EAAAC,EAAA,CAAA,SAAA,CAAAC,EAACvB,GAAO,cAAAO,EAA8B,IACrCiB,EAAQ,EAAA,EACTD,EAACE,EAAW,CAAA,QAAQ,KAAK,aAAY,GAAC,MAAO,CAAE,OAAQ,QAAS,EAAG,SAEnE,gBAAA,CAAA,EACAF,EAACG,EAAS,CAAA,OAAQvB,EAChB,SAAAoB,EAACI,GACE,SAAC,CAAA,CAAE,SAAAb,EAAU,OAAAC,CAAA,IAEVM,EAAC,QAAK,SAAWO,GAAMhB,EAAagB,EAAGd,EAAUC,CAAM,EACrD,SAAA,CAAAQ,EAACL,EAAY,EAAA,IACZ,KAAG,EAAA,EAAE,MAAE,KAAG,EAAA,EACXG,EAAC,MAAA,CACC,MAAO,CAAE,QAAS,OAAQ,eAAgB,eAAgB,EAE1D,SAAA,CAAAE,EAACM,EAAA,CACC,QAAQ,WACR,MAAM,YACN,QAASpB,EACV,SAAA,MAAA,CAED,EACAY,EAACQ,EAAA,CACC,KAAK,SACL,QAAQ,YACR,SAAU,CAACd,EACX,MAAM,YACP,SAAA,CAAA,OACMR,EAAc,SAAS,qBAAA,CAAA,CAC9B,CAAA,CAAA,CACF,CACF,CAAA,CAAA,EAGN,CACF,CAAA,CACF,CAAA,CAAA,CAEJ"}